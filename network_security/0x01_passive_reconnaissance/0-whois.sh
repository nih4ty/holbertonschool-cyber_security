#!/bin/bash
whois $1 | awk 'BEGIN{OFS=", "}/^(Registrant|Admin|Tech)/{t=$1} t!=""&&$2=="Name:"{print t" Name",substr($0,index($0,$3))} t!=""&&$2=="Organization:"{print t" Organization",substr($0,index($0,$3))} t!=""&&$2=="Street:"{s=substr($0,index($0,$3));sub(/[[:space:]]+$/,"",s);print t" Street",s} t!=""&&$2=="City:"{print t" City",substr($0,index($0,$3))} t!=""&&$2=="State/Province:"{print t" State/Province",substr($0,index($0,$3))} t!=""&&$2=="Postal"{print t" Postal Code",substr($0,index($0,$4))} t!=""&&$2=="Country:"{print t" Country",substr($0,index($0,$3))} t!=""&&$2=="Phone:"{print t" Phone",substr($0,index($0,$3))} t!=""&&$2=="Phone"&&$3=="Ext:"{print t" Phone Ext:",""} t!=""&&$2=="Fax:"{print t" Fax",""} t!=""&&$2=="Fax"&&$3=="Ext:"{print t" Fax Ext:",""} t!=""&&$2=="Email:"{print t" Email",substr($0,index($0,$3))}' > $1.csv
